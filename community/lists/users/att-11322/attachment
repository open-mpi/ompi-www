<html>
<head>
<style><!--
.hmmessage P
{
margin:0px;
padding:0px
}
body.hmmessage
{
font-size: 10pt;
font-family:Verdana
}
--></style>
</head>
<body class='hmmessage'>
I saw those options before but somehow I did not pay attention to them :(. <br>I was thinking that the copying is done automatically, so I felt the options were useless but I was wrong.<br>Thanks a lot Gus; that's exactly what I was looking for. I will try them then.<br><br>Best Regards.<br>~Belaid. <br><br>&gt; Date: Tue, 1 Dec 2009 15:14:01 -0500<br>&gt; From: gus@ldeo.columbia.edu<br>&gt; To: users@open-mpi.org<br>&gt; Subject: Re: [OMPI users] Elementary question on openMPI application location when using PBS submission<br>&gt; <br>&gt; Hi Belaid Moa<br>&gt; <br>&gt; I spoke too fast, and burnt my tongue.<br>&gt; I should have double checked before speaking out.<br>&gt; I just looked up "man mpiexec" and found the options below.<br>&gt; I never used or knew about them, but you may want to try.<br>&gt; They seem to be similar to the Torque/PBS stage_in feature.<br>&gt; I would guess they use scp to copy the executable and other<br>&gt; files to the nodes, but I don't really know which copying<br>&gt; mechanism is used.<br>&gt; <br>&gt; Gus Correa<br>&gt; ---------------------------------------------------------------------<br>&gt; Gustavo Correa<br>&gt; Lamont-Doherty Earth Observatory - Columbia University<br>&gt; Palisades, NY, 10964-8000 - USA<br>&gt; ---------------------------------------------------------------------<br>&gt; <br>&gt; #############################################<br>&gt; Excerpt from (OpenMPI 1.3.2) "man mpiexec":<br>&gt; #############################################<br>&gt; <br>&gt;         --preload-binary<br>&gt;                   Copy the specified executable(s) to remote machines <br>&gt; prior  to<br>&gt;                   starting  remote processes. The executables will be <br>&gt; copied to<br>&gt;                   the Open MPI session directory and will be deleted <br>&gt; upon  com-<br>&gt;                   pletion of the job.<br>&gt; <br>&gt;         --preload-files &lt;files&gt;<br>&gt;                   Preload  the  comma  separated  list  of files to the <br>&gt; current<br>&gt;                   working directory of the remote machines where <br>&gt; processes will<br>&gt;                   be launched prior to starting those processes.<br>&gt; <br>&gt;         --preload-files-dest-dir &lt;path&gt;<br>&gt;                   The  destination  directory  to be used for <br>&gt; preload-files, if<br>&gt;                   other than the current working  directory.  By <br>&gt; default,  the<br>&gt;                   absolute  and  relative paths provided by <br>&gt; --preload-files are<br>&gt;                   used.<br>&gt; <br>&gt; <br>&gt; ################################<br>&gt; <br>&gt; Gus Correa wrote:<br>&gt; &gt; Hi Belaid Moa<br>&gt; &gt; <br>&gt; &gt; Belaid MOA wrote:<br>&gt; &gt;&gt; Thank you very very much Gus. Does this mean that OpenMPI does not <br>&gt; &gt;&gt; copy the executable from the master node to the worker nodes?<br>&gt; &gt; <br>&gt; &gt; Not that I know.<br>&gt; &gt; Making the executable available on the nodes, and any<br>&gt; &gt; input files the program may need, is the user's responsibility,<br>&gt; &gt; not of mpiexec.<br>&gt; &gt; <br>&gt; &gt; On the other hand,<br>&gt; &gt; Torque/PBS has a "stage_in/stage_out" feature that is supposed to<br>&gt; &gt; copy files over to the nodes, if you want to give it a shot.<br>&gt; &gt; See "man qsub" and look into the (numerous) "-W" option under<br>&gt; &gt; the "stage[in,out]=file_list" sub-options.<br>&gt; &gt; This is a relic from the old days where everything had to be on<br>&gt; &gt; local disks on the nodes, and NFS ran over Ethernet 10/100,<br>&gt; &gt; but it is still used by people that<br>&gt; &gt; run MPI programs with heavy I/O, to avoid pounding on NFS or<br>&gt; &gt; even on parallel file systems.<br>&gt; &gt; I tried the stage_in/out feature a loooong time ago,<br>&gt; &gt; (old PBS before Torque), but it had issues.<br>&gt; &gt; It probably works now with the newer/better<br>&gt; &gt; versions of Torque.<br>&gt; &gt; <br>&gt; &gt; However, the easy way to get this right is just to use an NFS mounted<br>&gt; &gt; directory.<br>&gt; &gt; <br>&gt; &gt;&gt; If that's case, I will go ahead and NFS mount my working directory.<br>&gt; &gt;&gt;<br>&gt; &gt; <br>&gt; &gt; This would make your life much easier.<br>&gt; &gt; <br>&gt; &gt; My $0.02.<br>&gt; &gt; Gus Correa<br>&gt; &gt; ---------------------------------------------------------------------<br>&gt; &gt; Gustavo Correa<br>&gt; &gt; Lamont-Doherty Earth Observatory - Columbia University<br>&gt; &gt; Palisades, NY, 10964-8000 - USA<br>&gt; &gt; ---------------------------------------------------------------------<br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt; <br>&gt; &gt;&gt; ~Belaid.<br>&gt; &gt;&gt;<br>&gt; &gt;&gt;<br>&gt; &gt;&gt;  &gt; Date: Tue, 1 Dec 2009 13:50:57 -0500<br>&gt; &gt;&gt;  &gt; From: gus@ldeo.columbia.edu<br>&gt; &gt;&gt;  &gt; To: users@open-mpi.org<br>&gt; &gt;&gt;  &gt; Subject: Re: [OMPI users] Elementary question on openMPI <br>&gt; &gt;&gt; application location when using PBS submission<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; Hi Belaid MOA<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; See this FAQ:<br>&gt; &gt;&gt;  &gt; <br>&gt; &gt;&gt; http://www.open-mpi.org/faq/?category=running#do-i-need-a-common-filesystem <br>&gt; &gt;&gt;<br>&gt; &gt;&gt;  &gt; http://www.open-mpi.org/faq/?category=building#where-to-install<br>&gt; &gt;&gt;  &gt; http://www.open-mpi.org/faq/?category=tm#tm-obtain-host<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; Your executable needs to be on a directory that is accessible<br>&gt; &gt;&gt;  &gt; by all nodes in your node pool.<br>&gt; &gt;&gt;  &gt; An easy way to achieve this is to put it in a directory that<br>&gt; &gt;&gt;  &gt; is NFS mounted on all nodes, and launch your pbs script from there.<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; A less convenient alternative, if no NFS directory is available,<br>&gt; &gt;&gt;  &gt; is to copy the executable over to the nodes.<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; I also find it easier to write a PBS script instead of putting<br>&gt; &gt;&gt;  &gt; all the PBS directives in the command line.<br>&gt; &gt;&gt;  &gt; In this case you can put the lines below in your PBS script,<br>&gt; &gt;&gt;  &gt; to ensure all nodes will be on your work directory (cd <br>&gt; &gt;&gt; $PBS_O_WORKDIR):<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; ########<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; #PBS ... (PBS directives)<br>&gt; &gt;&gt;  &gt; ...<br>&gt; &gt;&gt;  &gt; cd $PBS_O_WORKDIR<br>&gt; &gt;&gt;  &gt; mpiexec -n ....<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; ########<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; IIRR, by default Torque/PBS puts you in your home directory on<br>&gt; &gt;&gt;  &gt; the nodes, which may or may not be the location of your executable.<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; I hope this helps,<br>&gt; &gt;&gt;  &gt; Gus Correa<br>&gt; &gt;&gt;  &gt; ---------------------------------------------------------------------<br>&gt; &gt;&gt;  &gt; Gustavo Correa<br>&gt; &gt;&gt;  &gt; Lamont-Doherty Earth Observatory - Columbia University<br>&gt; &gt;&gt;  &gt; Palisades, NY, 10964-8000 - USA<br>&gt; &gt;&gt;  &gt; ---------------------------------------------------------------------<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; Belaid MOA wrote:<br>&gt; &gt;&gt;  &gt; &gt; Hello everyone,<br>&gt; &gt;&gt;  &gt; &gt; I am new to this list and I have a very elementary question: <br>&gt; &gt;&gt; suppose we<br>&gt; &gt;&gt;  &gt; &gt; have three machines, HN (Head Node hosting the pbs server), WN1 (A<br>&gt; &gt;&gt;  &gt; &gt; worker node) and WN (another worker node). The PBS nodefile has <br>&gt; &gt;&gt; WN1 and<br>&gt; &gt;&gt;  &gt; &gt; WN2 in it (DOES NOT HAVE HN).<br>&gt; &gt;&gt;  &gt; &gt; My openMPI program (hello) and PBS script(my_script.sh) reside on <br>&gt; &gt;&gt; the<br>&gt; &gt;&gt;  &gt; &gt; HN. When I submit my PBS script using qsub -l nodes=2 <br>&gt; &gt;&gt; my_script.sh, I<br>&gt; &gt;&gt;  &gt; &gt; get the following error:<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; <br>&gt; &gt;&gt; -------------------------------------------------------------------------- <br>&gt; &gt;&gt;<br>&gt; &gt;&gt;  &gt; &gt; mpirun was unable to launch the specified application as it could <br>&gt; &gt;&gt; not<br>&gt; &gt;&gt;  &gt; &gt; find an executable:<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; Executable: hello<br>&gt; &gt;&gt;  &gt; &gt; Node: WN2<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; while attempting to start process rank 0.<br>&gt; &gt;&gt;  &gt; &gt; <br>&gt; &gt;&gt; -------------------------------------------------------------------------- <br>&gt; &gt;&gt;<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; How come my hello program is not copied automatically to the worker<br>&gt; &gt;&gt;  &gt; &gt; nodes? This leads to my elementary question:<br>&gt; &gt;&gt;  &gt; &gt; where the application should be when using a PBS submission?<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; Note that when I run mpirun from HN with machinefile containing <br>&gt; &gt;&gt; WN1 and<br>&gt; &gt;&gt;  &gt; &gt; WN2, I get the right output.<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; Any help on this is very appreciated.<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; ~Belaid.<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; <br>&gt; &gt;&gt; ------------------------------------------------------------------------<br>&gt; &gt;&gt;  &gt; &gt; Windows Live: Keep your friends up to date with what you do online.<br>&gt; &gt;&gt;  &gt; &gt; &lt;http://go.microsoft.com/?linkid=9691810&gt;<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; <br>&gt; &gt;&gt; ------------------------------------------------------------------------<br>&gt; &gt;&gt;  &gt; &gt;<br>&gt; &gt;&gt;  &gt; &gt; _______________________________________________<br>&gt; &gt;&gt;  &gt; &gt; users mailing list<br>&gt; &gt;&gt;  &gt; &gt; users@open-mpi.org<br>&gt; &gt;&gt;  &gt; &gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt; &gt;&gt;  &gt;<br>&gt; &gt;&gt;  &gt; _______________________________________________<br>&gt; &gt;&gt;  &gt; users mailing list<br>&gt; &gt;&gt;  &gt; users@open-mpi.org<br>&gt; &gt;&gt;  &gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt; &gt;&gt;<br>&gt; &gt;&gt; ------------------------------------------------------------------------<br>&gt; &gt;&gt; Windows Live: Make it easier for your friends to see what you’re up to <br>&gt; &gt;&gt; on Facebook. &lt;http://go.microsoft.com/?linkid=9691811&gt;<br>&gt; &gt;&gt;<br>&gt; &gt;&gt;<br>&gt; &gt;&gt; ------------------------------------------------------------------------<br>&gt; &gt;&gt;<br>&gt; &gt;&gt; _______________________________________________<br>&gt; &gt;&gt; users mailing list<br>&gt; &gt;&gt; users@open-mpi.org<br>&gt; &gt;&gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt; &gt; <br>&gt; &gt; _______________________________________________<br>&gt; &gt; users mailing list<br>&gt; &gt; users@open-mpi.org<br>&gt; &gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br>&gt; <br>&gt; _______________________________________________<br>&gt; users mailing list<br>&gt; users@open-mpi.org<br>&gt; http://www.open-mpi.org/mailman/listinfo.cgi/users<br> 		 	   		  <br /><hr />Get a great deal on Windows 7 and see how it works the way you want. <a href='http://go.microsoft.com/?linkid=9691813' target='_new'>See the Windows 7 offers now.</a></body>
</html>
