<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class="">FWIW: this is on Mac 10.10.2, using clang and clang++<div class=""><br class=""></div><div class="">OMPI master - bunch of warnings, but it successfully builds:</div><div class=""><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">In file included from ./libevent/event-internal.h:38:</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:64:6: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_ctor' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">void min_heap_ctor(min_heap_t* s) { s-&gt;p = 0; s-&gt;n = 0; s-&gt;a = 0; }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:65:6: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_dtor' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">void min_heap_dtor(min_heap_t* s) { if (s-&gt;p) mm_free(s-&gt;p); }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:66:6: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_elem_init' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">void min_heap_elem_init(struct event* e) { e-&gt;ev_timeout_pos.min_heap_idx = -1; }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:67:5: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_empty' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">int min_heap_empty(min_heap_t* s) { return 0u == s-&gt;n; }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:68:10: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_size' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">unsigned min_heap_size(min_heap_t* s) { return s-&gt;n; }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:69:15: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_top' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">struct event* min_heap_top(min_heap_t* s) { return s-&gt;n ? *s-&gt;p : 0; }</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:71:5: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_push' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">int min_heap_push(min_heap_t* s, struct event* e)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:79:15: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_pop' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">struct event* min_heap_pop(min_heap_t* s)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:91:5: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_elt_is_top' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">int min_heap_elt_is_top(const struct event *e)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">./libevent/minheap-internal.h:96:5: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">unused function 'min_heap_erase' [-Wunused-function]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">int min_heap_erase(min_heap_t* s, struct event* e)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp; &nbsp; ^</b></div><div class=""><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">osc_sm_passive_target.c:161:16: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">variable 'ret' is used uninitialized whenever 'if' condition is false [-Wsometimes-uninitialized]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">&nbsp; &nbsp; } else if (module-&gt;outstanding_locks[target] == lock_shared) {</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">osc_sm_passive_target.c:167:12: note: </b>uninitialized use occurs here</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">&nbsp; &nbsp; return ret;</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^~~</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">osc_sm_passive_target.c:161:12: note: </b>remove the 'if' if its condition is always true</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">&nbsp; &nbsp; } else if (module-&gt;outstanding_locks[target] == lock_shared) {</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">osc_sm_passive_target.c:148:12: note: </b>initialize the variable 'ret' to silence this warning</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">&nbsp; &nbsp; int ret;</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ^</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">1 warning generated.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><b class="">pml_cm_recv.c:85:6: </b><span style="font-variant-ligatures: no-common-ligatures; color: #d53bd3" class=""><b class="">warning: </b></span><b class="">no previous prototype for function 'mca_pml_cm_recv_fast_completion' [-Wmissing-prototypes]</b></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">void mca_pml_cm_recv_fast_completion(struct mca_mtl_request_t *mtl_request)</div><div style="margin: 0px; font-size: 11px; font-family: Menlo; color: rgb(52, 189, 38);" class=""><b class="">&nbsp;&nbsp; &nbsp; ^</b></div></div><div class=""><b class=""><br class=""></b></div><div class=""><b class=""><br class=""></b></div><div class="">OMPI v1.8 fails for me at an earlier stage:</div><div class=""><br class=""></div><div class=""><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">Making all in config</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make[1]: Nothing to be done for `all'.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">Making all in contrib</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make[1]: Nothing to be done for `all'.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">Making all in opal</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">Making all in include</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">/Applications/Xcode.app/Contents/Developer/usr/bin/make&nbsp; all-am</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make[3]: Nothing to be done for `all-am'.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">Making all in libltdl</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">CDPATH="${ZSH_VERSION+.}:" &amp;&amp; cd . &amp;&amp; /bin/sh /Users/rhc/openmpi/ompi-release/config/missing aclocal-1.15 -I ../../config</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">aclocal-1.15: error: ../../config/autogen_found_items.m4:304: file 'opal/mca/backtrace/configure.m4' does not exist</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make[2]: *** [aclocal.m4] Error 1</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make[1]: *** [all-recursive] Error 1</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">make: *** [all-recursive] Error 1</div></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><br class=""></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">I believe we have seen this before, and it was an issue caused by a change in libtool itself. The Mac automatically updated to the new version, which triggers the problem.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><br class=""></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">This is why we embedded ltdl directly into the OMPI master, and is why the master is building while the 1.8 branch is not.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><br class=""></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class="">I don’t have a ready fix at hand - might have to wait for Jeff to return next week to advise.</div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><br class=""></div><div style="margin: 0px; font-size: 11px; font-family: Menlo;" class=""><br class=""></div><div><blockquote type="cite" class=""><div class="">On Apr 6, 2015, at 2:41 PM, Paul Hargrove &lt;<a href="mailto:phhargrove@lbl.gov" class="">phhargrove@lbl.gov</a>&gt; wrote:</div><br class="Apple-interchange-newline"><div class=""><div dir="ltr" class="">On MacOS X 10.8 (where cc and c++ are clang and clang++, and the default ABI is LP64) I've configured the release candidate with<blockquote style="margin:0 0 0 40px;border:none;padding:0px" class=""><div class=""><font face="monospace, monospace" class="">--prefix=.... --enable-debug CC=cc CXX=c++</font></div></blockquote><div class=""><br class=""></div><div class=""><br class=""></div><div class="">The build fails linking opal_wrapper as shown in the "make V=1" output below.</div><div class=""><br class=""></div><div class="">Based on the undefined symbol (_lt_libltdlc_LTX_preloaded_symbols) I am guessing this is a libltdl issue.&nbsp; If relevant, note that configure picks the embedded libltdl:</div><div class=""><div class=""><br class=""></div><blockquote style="margin:0px 0px 0px 40px;border:none;padding:0px" class=""><div class=""><font face="monospace, monospace" class="">*** GNU libltdl setup</font></div><div class=""><font face="monospace, monospace" class="">checking location of libltdl... internal copy</font></div><div class=""><font face="monospace, monospace" class="">configure: OMPI configuring in opal/libltdl</font></div><div class=""><font face="monospace, monospace" class=""><br class=""></font></div></blockquote></div><div class="">Oddly enough, I have no problems with a build configured for the ILP32 ABI as follows:</div><blockquote style="margin:0 0 0 40px;border:none;padding:0px" class=""><div class=""><div class=""><font face="monospace, monospace" class="">--prefix=.... --enable-debug CC=cc CXX=c++ \</font></div></div><div class=""><font face="monospace, monospace" class="">CFLAGS=-m32 --with-wrapper-cflags=-m32 \</font></div><div class=""><font face="monospace, monospace" class="">CXXFLAGS=-m32 --with-wrapper-cxxflags=-m32 \</font></div><div class=""><font face="monospace, monospace" class="">FCFLAGS=-m32 --with-wrapper-fcflags=-m32</font></div></blockquote><div class=""><br class=""></div><div class="">I can send (off-list) the config.log and configure's complete stdout for both the LP64 and ILP32 builds if requested.</div><div class=""><br class=""></div><div class="">-Paul</div><div class=""><br class=""><div class=""><br clear="all" class=""><div class=""><div class=""><font face="monospace, monospace" class="">/bin/sh ../../../libtool &nbsp;--tag=CC &nbsp; --mode=link cc &nbsp;-g -finline-functions -fno-strict-aliasing &nbsp; -export-dynamic &nbsp;-Wl,-flat_namespace &nbsp;-o opal_wrapper opal_wrapper.o ../../../opal/<a href="http://libopen-pal.la/" class="">libopen-pal.la</a>&nbsp;</font></div><div class=""><font face="monospace, monospace" class="">libtool: link: cc -g -finline-functions -fno-strict-aliasing -Wl,-flat_namespace -o .libs/opal_wrapper opal_wrapper.o &nbsp;../../../opal/.libs/libopen-pal.dylib -lm</font></div><div class=""><font face="monospace, monospace" class="">Undefined symbols for architecture x86_64:</font></div><div class=""><font face="monospace, monospace" class="">&nbsp; "_lt_libltdlc_LTX_preloaded_symbols", referenced from:</font></div><div class=""><font face="monospace, monospace" class="">&nbsp; &nbsp; &nbsp; import-atom in libopen-pal.dylib</font></div><div class=""><font face="monospace, monospace" class="">ld: symbol(s) not found for architecture x86_64</font></div><div class=""><font face="monospace, monospace" class="">clang: error: linker command failed with exit code 1 (use -v to see invocation)</font></div><div class=""><font face="monospace, monospace" class="">make[2]: *** [opal_wrapper] Error 1</font></div><div class=""><font face="monospace, monospace" class="">make[1]: *** [all-recursive] Error 1</font></div><div class=""><font face="monospace, monospace" class="">make: *** [all-recursive] Error 1</font></div></div><div class=""><br class=""></div><div class=""><br class=""></div>-- <br class=""><div class="gmail_signature"><div dir="ltr" class=""><div class=""><font face="courier new, monospace" class=""><div class="">Paul H. Hargrove &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="mailto:PHHargrove@lbl.gov" target="_blank" class="">PHHargrove@lbl.gov</a></div><div class="">Computer Languages &amp; Systems Software (CLaSS) Group</div><div class="">Computer Science Department &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tel: +1-510-495-2352</div><div class="">Lawrence Berkeley National Laboratory &nbsp; &nbsp; Fax: +1-510-486-6900</div></font></div></div></div>
</div></div></div>
_______________________________________________<br class="">devel mailing list<br class=""><a href="mailto:devel@open-mpi.org" class="">devel@open-mpi.org</a><br class="">Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br class="">Link to this post: http://www.open-mpi.org/community/lists/devel/2015/04/17184.php</div></blockquote></div><br class=""></div></body></html>
