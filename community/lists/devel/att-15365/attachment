<html><head><meta http-equiv="Content-Type" content="text/html charset=windows-1252"></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">Yeah, my fix won't work for big endian machines - this is going to be an issue across the code base now, so we'll have to troll and fix it. I was doing the minimal change required to fix the trunk in the meantime.<div><br><div><div>On Jul 30, 2014, at 9:06 AM, George Bosilca &lt;<a href="mailto:bosilca@icl.utk.edu">bosilca@icl.utk.edu</a>&gt; wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div dir="ltr">Yes. opal_process_name_t has basically no meaning by itself, it is a 64 bits storage location used by the upper layer to save some local key that can be later used to extract information. Calling the OPAL level compare function might be a better fit there.<div>
<br></div><div>&nbsp; George.</div><div><br></div></div><div class="gmail_extra"><br><br><div class="gmail_quote">On Wed, Jul 30, 2014 at 11:50 AM, Gilles Gouaillardet <span dir="ltr">&lt;<a href="mailto:gilles.gouaillardet@gmail.com" target="_blank">gilles.gouaillardet@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>Ralph,</div><div><br></div><div>was it really that simple ?</div><div><br></div><div>proc_temp-&gt;super.proc_name has type opal_process_name_t :</div>
<div>typedef opal_identifier_t opal_process_name_t;</div>
<div>typedef uint64_t opal_identifier_t;</div><div><br></div><div>*but*</div><div><br></div><div>item_ptr-&gt;peer has type orte_process_name_t :</div><div>struct orte_process_name_t {</div><div>&nbsp; &nbsp;orte_jobid_t jobid;</div>

<div>&nbsp; &nbsp;orte_vpid_t vpid;</div><div>};</div><div><br></div><div>bottom line, is r32357 still valid on a big endian arch ?</div><div><br></div><div>Cheers,</div><div><br></div><div>Gilles</div><div class="gmail_extra"><br>

<br><div class="gmail_quote"><div><div class="h5">On Wed, Jul 30, 2014 at 11:49 PM, Ralph Castain <span dir="ltr">&lt;<a href="mailto:rhc@open-mpi.org" target="_blank">rhc@open-mpi.org</a>&gt;</span> wrote:<br></div></div>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div><div class="h5">
<div style="word-wrap:break-word">I just fixed this one - all that was required was an ampersand as the name was being passed into the function instead of a pointer to the name<div><br></div><div>r32357</div><div><br><div>

<div><div>On Jul 30, 2014, at 7:43 AM, Gilles GOUAILLARDET &lt;<a href="mailto:gilles.gouaillardet@gmail.com" target="_blank">gilles.gouaillardet@gmail.com</a>&gt; wrote:</div><br></div><blockquote type="cite">

<div>Rolf,<br><br>r32353 can be seen as a suspect...<br>Even if it is correct, it might have exposed the bug discussed in #4815 even more (e.g. we hit the bug 100% after the fix)<br><br>does the attached patch to #4815 fixes the problem ?<br>

<br>If yes, and if you see this issue as a showstopper, feel free to commit it and drop a note to #4815<br>( I am afk until tomorrow)<br><br>Cheers,<br><br>Gilles<br><br>Rolf vandeVaart &lt;<a href="mailto:rvandevaart@nvidia.com" target="_blank">rvandevaart@nvidia.com</a>&gt; wrote:<br>

<div><p>Just an FYI that my trunk version (r32355) does not work at all anymore if I do not include "--mca coll ^ml". &nbsp;&nbsp;&nbsp;Here is a stack trace from the ibm/pt2pt/send test running on a single node.<u></u><u></u></p><p><u></u>&nbsp;<u></u></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) where<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#0&nbsp; 0x00007f6c0d1321d0 in ?? ()<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#1&nbsp; &lt;signal handler called&gt;<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#2&nbsp; 0x00007f6c183abd52 in orte_util_compare_name_fields (fields=15 '\017', name1=0x192350001, name2=0xbaf76c) at ../../orte/util/name_fns.c:522<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#3&nbsp; 0x00007f6c0bea17be in bcol_basesmuma_smcm_allgather_connection (sm_bcol_module=0x7f6bf3b68040, module=0xb3d200, peer_list=0x7f6c0c0a6748, back_files=0x7f6bf3ffd6c8, <u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;comm=0x6037a0, input=..., base_fname=0x7f6c0bea2606 "sm_payload_mem_", map_all=false) at ../../../../../ompi/mca/bcol/basesmuma/bcol_basesmuma_smcm.c:237<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#4&nbsp; 0x00007f6c0be98307 in bcol_basesmuma_bank_init_opti (payload_block=0xbc0f60, data_offset=64, bcol_module=0x7f6bf3b68040, reg_data=0xba28c0)<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; at ../../../../../ompi/mca/bcol/basesmuma/bcol_basesmuma_buf_mgmt.c:302<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#5&nbsp; 0x00007f6c0cced386 in mca_coll_ml_register_bcols (ml_module=0xba5c40) at ../../../../../ompi/mca/coll/ml/coll_ml_module.c:510<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#6&nbsp; 0x00007f6c0cced68f in ml_module_memory_initialization (ml_module=0xba5c40) at ../../../../../ompi/mca/coll/ml/coll_ml_module.c:558<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#7&nbsp; 0x00007f6c0ccf06b1 in ml_discover_hierarchy (ml_module=0xba5c40) at ../../../../../ompi/mca/coll/ml/coll_ml_module.c:1539<u></u><u></u></span></p><p>
<span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#8&nbsp; 0x00007f6c0ccf4e0b in mca_coll_ml_comm_query (comm=0x6037a0, priority=0x7fffe7991b58) at ../../../../../ompi/mca/coll/ml/coll_ml_module.c:2963<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#9&nbsp; 0x00007f6c18cc5b09 in query_2_0_0 (component=0x7f6c0cf50940, comm=0x6037a0, priority=0x7fffe7991b58, module=0x7fffe7991b90)<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; at ../../../../ompi/mca/coll/base/coll_base_comm_select.c:372<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#10 0x00007f6c18cc5ac8 in query (component=0x7f6c0cf50940, comm=0x6037a0, priority=0x7fffe7991b58, module=0x7fffe7991b90)<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; at ../../../../ompi/mca/coll/base/coll_base_comm_select.c:355<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#11 0x00007f6c18cc59d2 in check_one_component (comm=0x6037a0, component=0x7f6c0cf50940, module=0x7fffe7991b90)<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp; at ../../../../ompi/mca/coll/base/coll_base_comm_select.c:317<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#12 0x00007f6c18cc5818 in check_components (components=0x7f6c18f46ef0, comm=0x6037a0) at ../../../../ompi/mca/coll/base/coll_base_comm_select.c:281<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#13 0x00007f6c18cbe3c9 in mca_coll_base_comm_select (comm=0x6037a0) at ../../../../ompi/mca/coll/base/coll_base_comm_select.c:117<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#14 0x00007f6c18c52301 in ompi_mpi_init (argc=1, argv=0x7fffe79924c8, requested=0, provided=0x7fffe79922e8) at ../../ompi/runtime/ompi_mpi_init.c:918<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#15 0x00007f6c18c86e92 in PMPI_Init (argc=0x7fffe799234c, argv=0x7fffe7992340) at pinit.c:84<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#16 0x0000000000401056 in main (argc=1, argv=0x7fffe79924c8) at send.c:32<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) up<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#1&nbsp; &lt;signal handler called&gt;<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) up<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">#2&nbsp; 0x00007f6c183abd52 in orte_util_compare_name_fields (fields=15 '\017', name1=0x192350001, name2=0xbaf76c) at ../../orte/util/name_fns.c:522<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">522&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (name1-&gt;jobid &lt; name2-&gt;jobid) {<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) print name1<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">$1 = (const orte_process_name_t *) 0x192350001<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) print *name1<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">Cannot access memory at address 0x192350001<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) print name2<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">$2 = (const orte_process_name_t *) 0xbaf76c<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb) print *name2<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">$3 = {jobid = 2452946945, vpid = 1}<u></u><u></u></span></p><p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">(gdb)<u></u><u></u></span></p><div><span style="font-size:10.0pt">&nbsp;</span><br class="webkit-block-placeholder"></div><p><u></u>&nbsp;<u></u></p><p><u></u>&nbsp;<u></u></p><p>&gt;-----Original Message-----</p><p>&gt;From: devel [<a href="mailto:devel-bounces@open-mpi.org" target="_blank">mailto:devel-bounces@open-mpi.org</a>] On Behalf Of Gilles</p><p>&gt;Gouaillardet</p><p>&gt;Sent: Wednesday, July 30, 2014 2:16 AM</p><p>&gt;To: Open MPI Developers</p><p>&gt;Subject: Re: [OMPI devel] trunk compilation errors in jenkins</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;George,</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;#4815 is indirectly related to the move :</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;in bcol/basesmuma, we used to compare ompi_process_name_t, and now</p><p>&gt;we (try to) compare an ompi_process_name_t and an opal_process_name_t</p><p>&gt;(which causes a glory SIGSEGV)</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;i proposed a temporary patch which is both broken and unelegant, could you</p><p>&gt;please advise a correct solution ?</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;Cheers,</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;Gilles</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;On 2014/07/27 7:37, George Bosilca wrote:</p><p>&gt;&gt; If you have any issue with the move, I’ll be happy to help and/or support</p><p>&gt;you on your last move toward a completely generic BTL. To facilitate your</p><p>&gt;work I exposed a minimalistic set of OMPI information at the OPAL level. Take</p><p>&gt;a look at opal/util/proc.h for more info, but please try not to expose more.</p><p>&gt;<u></u>&nbsp;<u></u></p><p>&gt;_______________________________________________</p><p>&gt;devel mailing list</p><p>&gt;<a href="mailto:devel@open-mpi.org" target="_blank"><span style="color:windowtext;text-decoration:none">devel@open-mpi.org</span></a></p><p>&gt;Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank"><span style="color:windowtext;text-decoration:none">http://www.open-mpi.org/mailman/listinfo.cgi/devel</span></a></p><p>&gt;Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/07/15348.php" target="_blank"><span style="color:windowtext;text-decoration:none">http://www.open-</span></a></p><p><a href="http://www.open-mpi.org/community/lists/devel/2014/07/15348.php" target="_blank"><span style="color:windowtext;text-decoration:none">&gt;mpi.org/community/lists/devel/2014/07/15348.php</span></a></p></div>
<div>
<hr>
</div>
<div>This email message is for the sole use of the intended recipient(s) and may 
contain confidential information.&nbsp; Any unauthorized review, use, disclosure 
or distribution is prohibited.&nbsp; If you are not the intended recipient, 
please contact the sender by reply email and destroy all copies of the original 
message. </div>
<div>
<hr>
</div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>

</div>Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/07/15355.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2014/07/15355.php</a></blockquote></div><br></div></div>

<br>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org" target="_blank">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br></div></div>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/07/15356.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2014/07/15356.php</a><br></blockquote></div><br></div></div>
<br>_______________________________________________<br>
devel mailing list<br>
<a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>
Subscription: <a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br>
Link to this post: <a href="http://www.open-mpi.org/community/lists/devel/2014/07/15363.php" target="_blank">http://www.open-mpi.org/community/lists/devel/2014/07/15363.php</a><br></blockquote></div><br></div>
_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>Subscription: http://www.open-mpi.org/mailman/listinfo.cgi/devel<br>Link to this post: http://www.open-mpi.org/community/lists/devel/2014/07/15364.php</blockquote></div><br></div></body></html>
