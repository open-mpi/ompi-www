<html><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; ">Tom,<div><br></div><div>This is because the code in OpenMPI presumes macros will be expanded in pragmas, but that is not required by the C standard. &nbsp;(See my e-mails below from last year with PGI, TPR 17186.) &nbsp;I fixed OpenMPI 1.4.3 configure in the attached patch. &nbsp;My patch also disables inline assembly for PGI C++, the same as for PGI C. &nbsp;(Something similar may also have to be done to solve Eugene's asm statement warnings on Solaris 11.) &nbsp;It also fixes detection of support for marshaling Fortran REAL16 and COMPLEX32 data types.</div><div><br><div apple-content-edited="true"> <span class="Apple-style-span" style="border-collapse: separate; color: rgb(0, 0, 0); font-family: 'Helvetica Neue'; font-size: medium; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-border-horizontal-spacing: 0px; -webkit-border-vertical-spacing: 0px; -webkit-text-decorations-in-effect: none; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; "><div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space; "><div><div><div><div><div><div><div><div><div><div>Larry Baker</div><div>US Geological Survey</div><div>650-329-5608</div><div><a href="mailto:baker@usgs.gov">baker@usgs.gov</a></div></div></div></div></div></div></div></div></div></div></div></span> </div><br><div><div>On 15 Nov 2011, at 12:49 PM, Thomas Rothrock CTR SMDC SimCtr/GaN Corporation wrote:</div><br class="Apple-interchange-newline"><blockquote type="cite"><div>I am building on a separate (unnetworked) system than the one I check out<br>SVN sources from, thus subversion was never installed on this system and the<br>"svnversion" command is unavailable. &nbsp;After configure, this eventually<br>results in OPAL_IDENT_STRING getting set to an empty string (""). &nbsp;This<br>seems to invoke an odd error in the Portland Group (PGI) C compiler (pgcc),<br>such that<br><br><span class="Apple-tab-span" style="white-space:pre">	</span>#pragma ident ""<br><br>results in:<br><br><span class="Apple-tab-span" style="white-space:pre">	</span>PGC-F-0010-File write error occurred (temporary pragma .s file)<br><br>which is is a bit misleading and took me a while to track down the problem.<br>My testing has shown that the C++ compiler (pgCC) does not fail with the<br>same error (or any error at all) and completes, but pgcc fails this case in<br>at least all versions since 8.0-6 and probably earlier. &nbsp;I have filed a<br>support request with PGI to see what they say about it, but of course this<br>does nothing for current and older versions. &nbsp;My quick workaround was to<br>just install subversion so that the empty string never gets set to begin<br>with. &nbsp;Ultimately though should OPAL_IDENT_STRING be ending up empty when<br>the "svnversion" command is not available?<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------------------------<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tom Rothrock &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<a href="mailto:Thomas.W.Rothrock.CTR@us.army.mil">Thomas.W.Rothrock.CTR@us.army.mil</a>&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;US Army Space &amp; Missile Defense Command Simulation Center<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;256-955-3382 (DSN 645) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FAX 256-955-1231<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<a href="http://www.sc.army.mil">http://www.sc.army.mil</a>&gt; Main SimCtr Phone: &nbsp;256-955-3750<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------------------------<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This email capability is supported by Department of Defense<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;systems and is subject to monitoring. &nbsp;Please refrain from<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using this address for non-Government purposes.<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------------------------<br><br><br>_______________________________________________<br>devel mailing list<br><a href="mailto:devel@open-mpi.org">devel@open-mpi.org</a><br>http://www.open-mpi.org/mailman/listinfo.cgi/devel</div></blockquote></div><br><div><span class="Apple-style-span" style="font-family: monospace; ">Larry Baker wrote:</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><blockquote type="cite" style="font-family: monospace; ">Dave,<br></blockquote><blockquote type="cite" style="font-family: monospace; "><br></blockquote><blockquote type="cite" style="font-family: monospace; ">I too read the C99 standard and found that macro substitution is not required in pragmas. &nbsp;I complained to the OpenMPI folks that they are relying a non-standard feature. &nbsp;The reason I brought this to your attention is to point out that pgcc and pgCC behave differently (puzzling), neither one describes their behavior, and ident is not documented as a recognized pragma. &nbsp;Please make sure the documentation is updated to describe whatever the behavior is for pgcc and pgCC.<br></blockquote><blockquote type="cite" style="font-family: monospace; "><br></blockquote><blockquote type="cite" style="font-family: monospace; ">Thanks,<br></blockquote><blockquote type="cite" style="font-family: monospace; "><br></blockquote><blockquote type="cite" style="font-family: monospace; ">Larry Baker<br></blockquote><blockquote type="cite" style="font-family: monospace; ">US Geological Survey<br></blockquote><blockquote type="cite" style="font-family: monospace; ">650-329-5608<br></blockquote><blockquote type="cite" style="font-family: monospace; "><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br></blockquote><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">Larry,</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">Thank you. I have added your remarks to the FTO, and included documentation into its</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">resolution.</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">dave</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><blockquote type="cite" style="font-family: monospace; "><br></blockquote><blockquote type="cite" style="font-family: monospace; ">On Oct 7, 2010, at 10:46 AM, PGI Technical Support wrote:<br></blockquote><blockquote type="cite" style="font-family: monospace; "><br></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">Larry,<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">An update to TPR 17186. =========================================================<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">For c99, it is not required to perform macro replacement in pragmas.<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">However, there are a few exceptions in pgc, such as within 'omp', 'pgi' &amp; 'acc' pragmas.<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">c99 does define a method which effects replacement within pragmas; the<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">method uses the _Pragma operator; e.g.,<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">#define FOO "foo"<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">#define IDENT(x) _Pragma("ident") x<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">IDENT(FOO)<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">will generate<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">#pragma ident "foo"<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">We will add allowing macro replacement within<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">'#pragma ident' &nbsp;in our 11.0 release.<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">==========================================================<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">regards,<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">dave<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">PGI Technical Support wrote:<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite">TPR 17186.<br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite">thanks again,<br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite">dave<br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite">Larry Baker wrote:<br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Customer information:<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Larry Baker<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">US Geological Survey<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">650-329-5608<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Product: 2183-WS<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">PIN: 507549<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Problem description:<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">pgcc issues the warning Pragma ignored – string expected after #pragma ident when compiling openmpi-1.4.2 from&nbsp;<a href="http://www.open-mpi.org/">http://www.open-mpi.org</a>.<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">The source of this problem is that OpenMPI #defines the string it wants to use in a #pragma ident instead of using a literal string value. &nbsp;However, pgcc does not perform macro substitution on #pragma ident statements. &nbsp;Curiously, pgCC does! &nbsp;This is not documented anywhere. &nbsp;Also, #pragma ident is not listed as a recognized pragma, even though it seems to be properly compiled into the ELF object file. &nbsp;It would be consistent with gcc and pgCC if pgcc would perform macro substitution in pragmas.<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">Larry Baker<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">US Geological Survey<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite">650-329-5608<br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><a href="mailto:baker@usgs.gov">baker@usgs.gov</a><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><blockquote type="cite"><br></blockquote></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">--&nbsp;<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">Dave Borer &nbsp;&nbsp;&nbsp;Customer Service Manager, The Portland Group<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">email &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="mailto:dave.borer@st.com">dave.borer@st.com</a><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite">phone &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(503)-431-7113<br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><blockquote type="cite"><br></blockquote></blockquote><blockquote type="cite" style="font-family: monospace; "><br></blockquote><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">--</span><span class="Apple-style-span" style="font-family: monospace; ">&nbsp;</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">Dave Borer</span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span class="Apple-style-span" style="font-family: monospace; ">Customer Service Manager, The Portland Group</span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">email</span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span class="Apple-style-span" style="font-family: monospace; "><a href="mailto:dave.borer@st.com">dave.borer@st.com</a></span><span class="Apple-style-span" style="font-family: monospace; "><br></span><span class="Apple-style-span" style="font-family: monospace; ">phone</span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-tab-span" style="white-space: pre; ">	</span></span><span class="Apple-style-span" style="font-family: monospace; ">(503)-431-7113</span><span class="Apple-style-span" style="font-family: monospace; "><span class="Apple-style-span" style="font-family: 'Helvetica Neue'; "></span></span></div></div></body></html>
