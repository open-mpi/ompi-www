<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
</head>
<body dir="ltr">
<style type="text/css" style="display:none;"><!-- P {margin-top:0;margin-bottom:0;} --></style>
<div dir="ltr" style="outline: medium none; font-size: 12pt; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-family: 'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols;" useinlinestyle="true" role="textbox" class="">
<p>Note where I said &quot;1 hour 14 minutes&quot; it should have read &quot;1 hour 24 minutes&quot;...</p>
<p><br>
</p>
<br>
<br>
<div style="color: rgb(33, 33, 33);">
<hr tabindex="-1" style="display:inline-block; width:98%">
<div id="divRplyFwdMsg" dir="ltr"><font style="font-size:11pt" color="#000000" face="Calibri, sans-serif"><b>From:</b> Tom Wurgler<br>
<b>Sent:</b> Friday, April 17, 2015 2:14 PM<br>
<b>To:</b> Open MPI Developers<br>
<b>Subject:</b> Re: [OMPI devel] Assigning processes to cores 1.4.2, 1.6.4 and 1.8.4</font>
<div>&nbsp;</div>
</div>
<div>
<div dir="ltr" class="" style="outline:medium none; font-size:12pt; color:rgb(0,0,0); background-color:rgb(255,255,255); font-family:'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols">
<div dir="ltr" class="" style="outline:medium none; font-size:12pt; color:rgb(0,0,0); background-color:rgb(255,255,255); font-family:'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols">
<div dir="ltr" class="" style="outline:medium none; font-size:12pt; color:rgb(0,0,0); background-color:rgb(255,255,255); font-family:'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols">
<div dir="ltr" class="" style="outline:medium none; font-size:12pt; color:rgb(0,0,0); background-color:rgb(255,255,255); font-family:'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols">
Ok, seems like I am making some progress here.&nbsp; Thanks for the help.<br>
I turned HT off.<br>
Now I can run v 1.4.2, 1.6.4 and 1.8.4 all compiled the same compiler and run on the same machine<br>
1.4.2 runs this job in 59 minutes.&nbsp;&nbsp; 1.6.4 and 1.8.4 run the job in 1hr 24 minutes.<br>
1.4.2 uses just --mca paffinuty-alone 1 and the processes are bound<br>
&nbsp;<span class="Apple-converted-space"> </span>PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
22232 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 469.9M [ 469.9M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22233 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; 479.0M [&nbsp; &nbsp;4.0M 475.0M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22234 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; 516.7M [ 516.7M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22235 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; 485.4M [&nbsp; &nbsp;8.0M 477.4M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22236 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4&nbsp; &nbsp; 482.6M [ 482.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22237 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5&nbsp; &nbsp; 486.6M [&nbsp; &nbsp;6.0M 480.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22238 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6&nbsp; &nbsp; 481.3M [ 481.3M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22239 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7&nbsp; &nbsp; 419.4M [&nbsp; &nbsp;8.0M 411.4M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br>
<br>
If I use 1.6.4 and 1.8.4 with --mca paffinity-alone 1, the run time is now 1hr 14 minutes.&nbsp; The process map now looks like:<br>
bash-4.3# numa-maps -n eagle<br>
&nbsp; PID COMMAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPUMASK&nbsp;&nbsp;&nbsp;&nbsp; TOTAL [&nbsp;&nbsp;&nbsp;&nbsp; N0&nbsp;&nbsp;&nbsp;&nbsp; N1&nbsp;&nbsp;&nbsp;&nbsp; N2&nbsp;&nbsp;&nbsp;&nbsp; N3&nbsp;&nbsp;&nbsp;&nbsp; N4&nbsp;&nbsp;&nbsp;&nbsp; N5 ]<br>
12248 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp; 163.3M [ 155.3M&nbsp;&nbsp; 8.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12249 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; 161.6M [ 159.6M&nbsp;&nbsp; 2.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12250 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp; 164.3M [ 160.3M&nbsp;&nbsp; 4.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12251 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6&nbsp;&nbsp;&nbsp; 160.4M [ 156.4M&nbsp;&nbsp; 4.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12252 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp; 160.6M [ 154.6M&nbsp;&nbsp; 6.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12253 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp; 159.8M [ 151.8M&nbsp;&nbsp; 8.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12254 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12&nbsp;&nbsp;&nbsp; 160.9M [ 152.9M&nbsp;&nbsp; 8.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
12255 eagle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14&nbsp;&nbsp;&nbsp; 159.8M [ 157.8M&nbsp;&nbsp; 2.0M&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; ]<br>
<br>
If I take off the --mca paffinity-alone 1, and instead use --bysocket --bind-to-core (1.6.4)&nbsp; or --map-by socket --bind-to core (1.8.4), the job runs in 59 minutes and the process map look like the 1.4.2 one above...looks super!<br>
<br>
Now the issue:<br>
<br>
If I move the same openmi install dirs to our cluster nodes, I can run 1.64&#43; using the --mca paffinity-alone 1 options and the job runs (taking longer etc).<br>
<br>
If I then try the --bysocket --bind-to-core etc, I get the following error:<br>
<br>
<font size="2"><span style="font-size:10pt">--------------------------------------------------------------------------<br>
An attempt to set processor affinity has failed - please check to<br>
ensure that your system supports such functionality. If so, then<br>
this is probably something that should be reported to the OMPI developers.<br>
--------------------------------------------------------------------------<br>
--------------------------------------------------------------------------<br>
mpirun was unable to start the specified application as it encountered an error:<br>
<br>
Error name: Input/output error<br>
Node: rdsargo36<br>
<br>
when attempting to start process rank 0.<br>
--------------------------------------------------------------------------<br>
Error: Previous command failed (exitcode=1</span></font><br>
<br>
Now the original runs were done on an Intel box (and this is where OpenMPI was comilped).<br>
I am trying to run now on an AMD based cluster node.<br>
<br>
So --mca paffinity-alone 1&nbsp; works<br>
&nbsp;&nbsp;&nbsp;&nbsp; --bysocket --bind-to-core doesn't.<br>
<br>
Does this make sense to you folks?&nbsp; If the AMD (running SuSE 11.1, BTW) doesn't support paffinity, why does the --mca version run?&nbsp; Is there some way to check/set whether a system would support --bysocket etc?&nbsp; Does it matter which machine I compiled on?<br>
<br>
And compare the following:<br>
<br>
<font size="2"><span style="font-size:10pt">[test_lsf2]rds4020[1010]% /apps/share/openmpi/1.6.4.I1404211/bin/ompi_info | grep -i affinity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MPI extensions: affinity example<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA paffinity: hwloc (MCA v2.0, API v2.0, Component v1.6.4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA maffinity: first_use (MCA v2.0, API v2.0, Component v1.6.4)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA maffinity: hwloc (MCA v2.0, API v2.0, Component v1.6.4)<br>
<br>
[test_lsf2]rds4020[1010]% /apps/share/openmpi/1.4.2.I1404211/bin/ompi_info | grep -i affinity<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA paffinity: linux (MCA v2.0, API v2.0, Component v1.4.2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA maffinity: first_use (MCA v2.0, API v2.0, Component v1.4.2)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MCA maffinity: libnuma (MCA v2.0, API v2.0, Component v1.4.2)<br>
<br>
[test_lsf2]rds4020[1012]% /apps/share/openmpi/1.8.4.I1404211/bin/ompi_info | grep -i affinity<br>
</span></font>(no output)<br>
<br>
Shouldn't the 1.8.4 version show something?<br>
<br>
Thank again for the help so far and appreciate any comments/help on the above.<br>
tom<br>
<div style="color:rgb(33,33,33)">
<hr tabindex="-1" style="display:inline-block; width:98%">
<div id="divRplyFwdMsg" dir="ltr"><font style="font-size:11pt" color="#000000" face="Calibri, sans-serif"><b>From:</b> devel &lt;devel-bounces@open-mpi.org&gt; on behalf of Ralph Castain &lt;rhc@open-mpi.org&gt;<br>
<b>Sent:</b> Friday, April 10, 2015 11:38 AM<br>
<b>To:</b> Open MPI Developers<br>
<b>Subject:</b> Re: [OMPI devel] Assigning processes to cores 1.4.2, 1.6.4 and 1.8.4</font>
<div>&nbsp;</div>
</div>
<div>Your configure options look fine.
<div class=""><br class="">
</div>
<div class="">Getting 1 process assigned to each core (irrespective of HT on or off):</div>
<div class=""><br class="">
</div>
<div class="">—map-by core —bind-to core</div>
<div class=""><br class="">
</div>
<div class="">This will tight-pack the processes - i.e., they will be placed on each successive core. If you want to balance the load across the allocation (if the #procs &lt; #cores in allocation):</div>
<div class=""><br class="">
</div>
<div class="">—map-by node —bind-to core</div>
<div class=""><br class="">
</div>
<div class="">HTH</div>
<div class="">Ralph</div>
<div class=""><br class="">
</div>
<div class=""><br class="">
<div>
<blockquote type="cite" class="">
<div class="">On Apr 10, 2015, at 7:24 AM, Tom Wurgler &lt;<a href="mailto:twurgl@goodyear.com" class="">twurgl@goodyear.com</a>&gt; wrote:</div>
<br class="Apple-interchange-newline">
<div class="">
<div dir="ltr" class="" style="font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; outline:none medium; font-size:12pt; background-color:rgb(255,255,255); font-family:'Times New Roman',Times,serif,'Apple Color Emoji','Segoe UI Emoji',NotoColorEmoji,'Segoe UI Symbol','Android Emoji',EmojiSymbols">
<div class="" style="margin-top:0px; margin-bottom:0px">Thanks for the responses.&nbsp;<span class="Apple-converted-space">&nbsp;</span><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">The idea is to bind one process per processor.&nbsp; The actual problem that prompted the investigation is that a job</div>
<div class="" style="margin-top:0px; margin-bottom:0px">ran with 1.4.2 runs in 59 minutes and the same job in 1.6.4 and 1.8.4 takes 79 minutes on the same machine, same compiler etc.&nbsp; In trying to track down the reason for the run time differences, I found
 that the behavior is different regarding the binding.&nbsp; Hence the question.</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">I believe it is doing what we requested, but not what we want.&nbsp; The bind-to-socket was just one attempt at making</div>
<div class="" style="margin-top:0px; margin-bottom:0px">it bind one per processor.&nbsp; I tried about 15 different combinations of the mpirun args and none matched the behavior of 1.4.2 or the run time of 1.4.2 and is a huge concern for us.</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">I just checked this machine and hyperthreading is on.&nbsp; I can change that and retest.</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">Are my configure options ok for the 1.6.4&#43; configuring?</div>
<div class="" style="margin-top:0px; margin-bottom:0px">And what mpirun options should I be using to get 1 process per processor?</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">This job was an 8 core test job, but the core counts varies per type of job (and will be run on the big clusters, not this compile server).</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">The run time differences show up across all our clusters, Intel based, AMD based, various SuSE OS versions.<br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px"><br class="">
</div>
<div class="" style="margin-top:0px; margin-bottom:0px">thanks</div>
<div class="" style="margin-top:0px; margin-bottom:0px">tom<br class="">
</div>
<br class="">
<div class="" style="color:rgb(33,33,33)">
<hr tabindex="-1" class="" style="display:inline-block; width:948.625px">
<div id="divRplyFwdMsg" dir="ltr" class=""><font class="" style="font-size:11pt" face="Calibri, sans-serif"><b class="">From:</b><span class="Apple-converted-space">&nbsp;</span>devel &lt;<a href="mailto:devel-bounces@open-mpi.org" class="">devel-bounces@open-mpi.org</a>&gt;
 on behalf of Ralph Castain &lt;<a href="mailto:rhc@open-mpi.org" class="">rhc@open-mpi.org</a>&gt;<br class="">
<b class="">Sent:</b><span class="Apple-converted-space">&nbsp;</span>Friday, April 10, 2015 9:54 AM<br class="">
<b class="">To:</b><span class="Apple-converted-space">&nbsp;</span>Open MPI Developers<br class="">
<b class="">Subject:</b><span class="Apple-converted-space">&nbsp;</span>Re: [OMPI devel] Assigning processes to cores 1.4.2, 1.6.4 and 1.8.4</font>
<div class="">&nbsp;</div>
</div>
<div class="">Actually, I believe from the cmd line that the questioner wanted each process to be bound to a single core.
<div class=""><br class="">
</div>
<div class="">From your output, I’m guessing you have hyperthreads enabled on your system - yes? In that case, the 1.4 series is likely to be binding each process to a single HT because it isn’t sophisticated enough to realize the difference between HT and
 core.</div>
<div class=""><br class="">
</div>
<div class="">Later versions of OMPI do know the difference. When you tell OMPI to bind to core, it will bind you to -both- HTs of that core. Hence the output you showed here:</div>
<div class=""><br class="">
</div>
<div class="">
<blockquote type="cite" class="">
<div class="gmail_extra">
<div class="gmail_quote">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
<div class="gmail_extra">
<div class="">
<div class="h5">
<div class="gmail_quote">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
here is the map using just --mca mpi_paffinity_alone 1<br class="">
<br class="">
&nbsp;&nbsp;PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
25846 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0,16&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25847 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2,18&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25848 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4,20&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25849 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6,22&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25850 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8,24&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25851 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10,26&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25852 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12,28&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25853 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14,30&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
</blockquote>
</div>
</div>
</div>
</div>
</blockquote>
</div>
</div>
</blockquote>
<br class="">
</div>
<div class=""><br class="">
</div>
<div class="">When you tell us bind-to socket, we bind you to every HT in that socket. Since you are running less than 8 processes, and we map-by core by default, all the processes are bound to the first socket. This is what you show in this output:</div>
<div class=""><br class="">
</div>
<div class="">
<blockquote type="cite" class="">
<div class="gmail_extra">
<div class="gmail_quote">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
<div class="gmail_extra">
<div class="">
<div class="h5">
<div class="gmail_quote">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
We get the following process map (this output is with mpirun args --bind-to-socket<br class="">
--mca mpi_paffinity_alone 1):<br class="">
<br class="">
&nbsp;&nbsp;PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
24176 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.2M [&nbsp; 60.2M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24177 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24178 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24179 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24180 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24181 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24182 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24183 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
</blockquote>
</div>
</div>
</div>
</div>
</blockquote>
</div>
</div>
</blockquote>
<div class=""><br class="">
</div>
<div class=""><br class="">
</div>
So it looks to me like OMPI is doing exactly what you requested. I admit the HT numbering in the cpumask is strange, but that’s the way your BIOS numbered them.</div>
<div class=""><br class="">
</div>
<div class="">HTH</div>
<div class="">Ralph</div>
<div class=""><br class="">
</div>
<div class=""><br class="">
<div class="">
<blockquote type="cite" class="">
<div class="">On Apr 10, 2015, at 6:29 AM, Nick Papior Andersen &lt;<a href="mailto:nickpapior@gmail.com" class="">nickpapior@gmail.com</a>&gt; wrote:</div>
<br class="Apple-interchange-newline">
<div class="">
<div dir="ltr" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
Bug, it should be &quot;span,pe=2&quot;</div>
<div class="gmail_extra" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<br class="">
<div class="gmail_quote">2015-04-10 15:28 GMT&#43;02:00 Nick Papior Andersen<span class="Apple-converted-space">&nbsp;</span><span dir="ltr" class="">&lt;<a href="mailto:nickpapior@gmail.com" target="_blank" class="">nickpapior@gmail.com</a>&gt;</span>:<br class="">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
<div dir="ltr" class="">I guess you want process #1 to have core 0 and core 1 bound to it, process #2 have core 2 and core 3 bound?
<div class=""><br class="">
</div>
<div class="">I can do this with (I do this with 1.8.4, I do not think it works with 1.6.x):</div>
<div class="">--map-by ppr:4:socket:span:pe=2</div>
<div class="">ppr = processes per resource.</div>
<div class="">socket = the resource</div>
<div class="">span = load balance the processes</div>
<div class="">pe = bind processing elements to each process</div>
<div class=""><br class="">
</div>
<div class="">This should launch 8 processes (you have 2 sockets). Each process should have 2 processing elements bound to it.</div>
<div class="">You can check with --report-bindings to see the &quot;bound&quot; processes bindings.</div>
</div>
<div class="gmail_extra">
<div class="">
<div class="h5"><br class="">
<div class="gmail_quote">2015-04-10 15:16 GMT&#43;02:00<span class="Apple-converted-space">&nbsp;</span><span class="Apple-converted-space">&nbsp;</span><span dir="ltr" class="">&lt;<a href="mailto:twurgl@goodyear.com" target="_blank" class="">twurgl@goodyear.com</a>&gt;</span>:<br class="">
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex; border-left-width:1px; border-left-color:rgb(204,204,204); border-left-style:solid; padding-left:1ex">
<br class="">
We can't seem to get &quot;processor affinity&quot; using 1.6.4 or newer OpenMPI.<br class="">
<br class="">
Note this is a 2 socket machine with 8 cores per socket<br class="">
<br class="">
We had compiled OpenMPI 1.4.2 with the following configure options:<br class="">
<br class="">
===========================================================================<br class="">
export CC=/apps/share/intel/v14.0.4.211/bin/icc<br class="">
export CXX=/apps/share/intel/v14.0.4.211/bin/icpc<br class="">
export FC=/apps/share/intel/v14.0.4.211/bin/ifort<br class="">
<br class="">
version=1.4.2.I1404211<br class="">
<br class="">
./configure \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--prefix=/apps/share/openmpi/$version \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--disable-shared \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-static \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-shared=no \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-openib \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-libnuma=/usr \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-mpirun-prefix-by-default \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-memory-manager=none \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-tm=/apps/share/TORQUE/current/Linux<br class="">
===========================================================================<br class="">
<br class="">
and then used this mpirun command (where we used 8 cores):<br class="">
<br class="">
===========================================================================<br class="">
/apps/share/openmpi/1.4.2.I1404211/bin/mpirun \<br class="">
--prefix /apps/share/openmpi/1.4.2.I1404211 \<br class="">
--mca mpi_paffinity_alone 1 \<br class="">
--mca btl openib,tcp,sm,self \<br class="">
--x LD_LIBRARY_PATH \<br class="">
{model args}<br class="">
===========================================================================<br class="">
<br class="">
And when we checked the process map, it looks like this:<br class="">
<br class="">
&nbsp;<span class="Apple-converted-space">&nbsp;</span>PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
22232 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; 469.9M [ 469.9M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22233 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; 479.0M [&nbsp; &nbsp;4.0M 475.0M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22234 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; 516.7M [ 516.7M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22235 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3&nbsp; &nbsp; 485.4M [&nbsp; &nbsp;8.0M 477.4M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22236 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4&nbsp; &nbsp; 482.6M [ 482.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22237 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5&nbsp; &nbsp; 486.6M [&nbsp; &nbsp;6.0M 480.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22238 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;6&nbsp; &nbsp; 481.3M [ 481.3M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
22239 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;7&nbsp; &nbsp; 419.4M [&nbsp; &nbsp;8.0M 411.4M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
<br class="">
Now with 1.6.4 and higher, we did the following:<br class="">
===========================================================================<br class="">
export CC=/apps/share/intel/v14.0.4.211/bin/icc<br class="">
export CXX=/apps/share/intel/v14.0.4.211/bin/icpc<br class="">
export FC=/apps/share/intel/v14.0.4.211/bin/ifort<br class="">
<br class="">
version=1.6.4.I1404211<br class="">
<br class="">
./configure \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--disable-vt \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--prefix=/apps/share/openmpi/$version \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--disable-shared \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-static \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-verbs \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-mpirun-prefix-by-default \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-memory-manager=none \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-hwloc \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--enable-mpi-ext \<br class="">
&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;</span>--with-tm=/apps/share/TORQUE/current/Linux<br class="">
===========================================================================<br class="">
<br class="">
We've tried the same mpirun command, with -bind-to-core, with -bind-to-core -bycore etc<br class="">
and I can't seem to get the right combination of args to get the same behavior as 1.4.2.<br class="">
<br class="">
We get the following process map (this output is with mpirun args --bind-to-socket<br class="">
--mca mpi_paffinity_alone 1):<br class="">
<br class="">
&nbsp;<span class="Apple-converted-space">&nbsp;</span>PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
24176 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.2M [&nbsp; 60.2M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24177 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24178 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24179 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24180 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24181 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24182 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
24183 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30&nbsp; &nbsp; &nbsp;60.5M [&nbsp; 60.5M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
<br class="">
here is the map using just --mca mpi_paffinity_alone 1<br class="">
<br class="">
&nbsp;<span class="Apple-converted-space">&nbsp;</span>PID COMMAND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CPUMASK&nbsp; &nbsp; &nbsp;TOTAL [&nbsp; &nbsp; &nbsp;N0&nbsp; &nbsp; &nbsp;N1&nbsp; &nbsp; &nbsp;N2&nbsp; &nbsp; &nbsp;N3&nbsp; &nbsp; &nbsp;N4&nbsp; &nbsp; &nbsp;N5 ]<br class="">
25846 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0,16&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25847 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2,18&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25848 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4,20&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25849 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6,22&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25850 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8,24&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25851 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10,26&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25852 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;12,28&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
25853 prog1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14,30&nbsp; &nbsp; &nbsp;60.6M [&nbsp; 60.6M&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; 0&nbsp; ]<br class="">
<br class="">
I figure I am compiling incorrectly or using the wrong mpirun args.<br class="">
<br class="">
Can someone tell me how to duplicate the behavior of 1.4.2 regarding binding the processes to cores?<br class="">
<br class="">
Any help appreciated..<br class="">
<br class="">
thanks<br class="">
<br class="">
tom<br class="">
_______________________________________________<br class="">
devel mailing list<br class="">
<a href="mailto:devel@open-mpi.org" target="_blank" class="">devel@open-mpi.org</a><br class="">
Subscription:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" target="_blank" class="">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class="">
Link to this post:<span class="Apple-converted-space">&nbsp;</span><a href="http://www.open-mpi.org/community/lists/devel/2015/04/17205.php" target="_blank" class="">http://www.open-mpi.org/community/lists/devel/2015/04/17205.php</a><br class="">
</blockquote>
</div>
<br class="">
<br class="" clear="all">
<div class=""><br class="">
</div>
</div>
</div>
<span class="HOEnZb"><font class="" color="#888888">--<span class="Apple-converted-space">&nbsp;</span><br class="">
<div class="">
<div dir="ltr" class="">
<div class="">Kind regards Nick</div>
</div>
</div>
</font></span></div>
</blockquote>
</div>
<br class="">
<br class="" clear="all">
<div class=""><br class="">
</div>
--<span class="Apple-converted-space">&nbsp;</span><br class="">
<div class="gmail_signature">
<div dir="ltr" class="">
<div class="">Kind regards Nick</div>
</div>
</div>
</div>
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">_______________________________________________</span><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">devel
 mailing list</span><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<a href="mailto:devel@open-mpi.org" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">devel@open-mpi.org</a><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">Subscription:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">Link
 to this post:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/devel/2015/04/17207.php" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">http://www.open-mpi.org/community/lists/devel/2015/04/17207.php</a></div>
</blockquote>
</div>
<br class="">
</div>
</div>
</div>
</div>
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">_______________________________________________</span><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">devel
 mailing list</span><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<a href="mailto:devel@open-mpi.org" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">devel@open-mpi.org</a><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">Subscription:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/mailman/listinfo.cgi/devel" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">http://www.open-mpi.org/mailman/listinfo.cgi/devel</a><br class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">
<span class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px; float:none; display:inline!important">Link
 to this post:<span class="Apple-converted-space">&nbsp;</span></span><a href="http://www.open-mpi.org/community/lists/devel/2015/04/17209.php" class="" style="font-family:Helvetica; font-size:12px; font-style:normal; font-variant:normal; font-weight:normal; letter-spacing:normal; line-height:normal; orphans:auto; text-align:start; text-indent:0px; text-transform:none; white-space:normal; widows:auto; word-spacing:0px">http://www.open-mpi.org/community/lists/devel/2015/04/17209.php</a></div>
</blockquote>
</div>
<br class="">
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>

